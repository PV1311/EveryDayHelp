<!DOCTYPE html>
<html xmlns:th="www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title th:text="${title}"></title>

    <th:block th:replace="~{fragments/common_css::commonCss}"></th:block>
  </head>
  <body>
  
    <header th:replace="~{fragments/header::headerFragment}"></header>
  
    <div th:if="${msg}" class="alert alert-danger alert-dismissible fade show mx-3 my-3 text-center" role="alert">
      <span th:text="${msg}"></span>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <main class="main-body container mt-5 mb-5">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="card shadow-lg">
            <div class="card-body">
              <h2 class="text-center mb-4">Registration Form</h2>

              <!-- For uploading any type of data, we need to specify enctype="multipart/form-data" attribute in the form as we did below -->
              <!-- For uploading pic, we specify type="file" and name will be different from the entity filed, so then spring container will not
                   recognise it and in the object that it will send to container, it will not put the pic. To set the amount of file size user
                   can upload, we set a property in application properties file called spring.servlet.multipart.max-file-size -->
              <form
                action="/userRegister"
                method="post"
                class="needs-validation"
                novalidate
                enctype="multipart/form-data"
              >
                <div class="mb-3">
                  <label for="name" class="form-label">Name</label>
                  <input
                    type="text"
                    class="form-control"
                    id="name"
                    name="name"
                    required
                  />
                  <div class="invalid-feedback">Please enter your name.</div>
                </div>

                <div class="mb-3">
                  <label for="email" class="form-label">Email</label>
                  <input
                    type="email"
                    class="form-control"
                    id="email"
                    name="email"
                    required
                  />
                  <div class="invalid-feedback">
                    Please enter a valid email.
                  </div>
                </div>

                <div class="mb-3">
                  <label for="phone" class="form-label">Phone</label>
                  <input
                    type="tel"
                    class="form-control"
                    id="phone"
                    name="phone"
                    required
                    pattern="[0-9]{10}"
                  />
                  <div class="invalid-feedback">
                    Please enter a valid 10-digit phone number.
                  </div>
                </div>

                <div class="mb-3">
                  <label for="address" class="form-label">Address</label>
                  <textarea
                    class="form-control"
                    id="address"
                    name="address"
                    rows="3"
                    required
                  ></textarea>
                  <div class="invalid-feedback">Please enter your address.</div>
                </div>

                <div class="mb-3">
                  <label for="pic" class="form-label"
                    >Profile Picture (URL or Path)</label
                  >
                  <input
                    type="file"
                    class="form-control"
                    id="pic"
                    name="profilepic"
                    required
                  />
                  <div class="invalid-feedback">
                    Please provide a picture URL or path.
                  </div>
                </div>

                <div class="mb-3">
                  <label for="password" class="form-label">Password</label>
                  <input
                    type="password"
                    class="form-control"
                    id="password"
                    name="password"
                    required
                    minlength="6"
                  />
                  <div class="invalid-feedback">
                    Please enter a password (min 6 characters).
                  </div>
                </div>

                <div class="d-grid">
                  <button type="submit" class="btn btn-primary">
                    Register
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </main>
    
    <footer th:replace="~{fragments/footer::footerFragment}"></footer>

    <script>
      // Bootstrap form validation
      (function () {
        "use strict";
        const forms = document.querySelectorAll(".needs-validation");
        Array.from(forms).forEach(function (form) {
          form.addEventListener(
            "submit",
            function (event) {
              if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
              }
              form.classList.add("was-validated");
            },
            false
          );
        });
      })();
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
