<!DOCTYPE html>
<html xmlns:th="www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title th:text="${title}"></title>

    <th:block th:replace="~{fragments/common_css::commonCss}"></th:block>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </head>
  <body>
    <header th:replace="~{fragments/admin_header::adminHeaderFragment}"></header>

    <div class="main-body">
      <!-- <div
      th:if="${msg}"
      class="alert alert-danger alert-dismissible fade show mx-3 my-3 text-center"
      role="alert"
    >
      <span th:text="${msg}"></span>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="alert"
        aria-label="Close"
      ></button>
    </div> -->

      <p id="msg1" th:text="${msg}" style="display: none"></p>

      <div th:if="${msg}">
        <script th:inline="javascript">
          // To associate JS with our code, thymeleaf says to make the <script> as here and make it inline by doing th:inline="javascript"

          /* let message = [[${msg}]] */ // This is actual syntaxt of thymeleaf, but STS doesn't understand it, so it gives error. So we do so as below

          let message = document.getElementById("msg1").textContent; // We fill the message in a <p> element above, set it's display none, and access the
          //                                                            element here to fill the message in the sweet alert

          Swal.fire({
            title: "Notice Message",
            text: message,
            icon: "success",
          });
        </script>
      </div>

      <main class="container mt-5 mb-5">
        <div class="row justify-content-center">
          <div class="col-md-6">
            <div class="card shadow-lg">
              <div class="card-body">
                <h3 class="text-center mb-4">Add Notice</h3>
                <form
                  method="post"
                  th:object="${noticeObj}"
                  th:action="@{/admin/postNotice}"
                  class="needs-validation"
                  novalidate
                >
                  <!-- This noticeObj is coming from the attribute added in Model from GetMapping -->

                  <div class="mb-3">
                    <label for="title" class="form-label">Title</label>
                    <input
                      type="text"
                      th:field="*{title}"
                      class="form-control"
                      id="title"
                      placeholder="Enter notice title"
                      required
                    />
                    <div class="invalid-feedback">Title is required.</div>
                    <!-- Here the the:field is the field name we gave in our AdminNotice model(entity) class, So the title we wrote inside th:field="*{}"
                         here is the title field from AdminNotice.java. Here we can remove the name attribute -->
                  </div>

                  <div class="mb-3">
                    <label for="description" class="form-label"
                      >Description</label
                    >
                    <textarea
                      th:field="*{description}"
                      class="form-control"
                      id="description"
                      rows="4"
                      placeholder="Enter notice description"
                      required
                    ></textarea>
                    <div class="invalid-feedback">Description is required.</div>
                  </div>

                  <div class="d-grid">
                    <!--  on clicking on submit button, request will go ti post mapping(/admin/postNotice) and there data will be received through Model
                    attribute -->
                    <button type="submit" class="btn btn-primary">
                      Add Notice
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <footer th:replace="~{fragments/admin_footer::adminFooterFragment}"></footer>

    <script>
      (() => {
        "use strict";
        const forms = document.querySelectorAll(".needs-validation");
        Array.from(forms).forEach((form) => {
          form.addEventListener(
            "submit",
            (event) => {
              if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
              }
              form.classList.add("was-validated");
            },
            false
          );
        });
      })();
    </script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
